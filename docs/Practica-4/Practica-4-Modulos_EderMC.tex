\documentclass[a4paper,12pt]{report}
\usepackage[spanish]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{float}
\usepackage[margin=2.5cm]{geometry}
% ===== Numeración de secciones =====
\renewcommand\thesection{\arabic{section}}
\makeatletter
\makeatother
\usepackage[hidelinks]{hyperref}
% ===== Imagenes =====
\usepackage{graphicx}
\DeclareGraphicsExtensions{.png}
\graphicspath{{images/}}
% ===== Tablas =====
\usepackage{array}
\usepackage{tabularx}
\newcolumntype{Y}{>{\raggedright\arraybackslash}X}
% ===== Estilos para el recuadro bash para API =====
\usepackage{xcolor}
\usepackage{listings}
\definecolor{codebg}{RGB}{245,245,245}
\lstdefinestyle{bash}{
  language=bash,
  basicstyle=\ttfamily\small,
  backgroundcolor=\color{codebg},
  frame=single,
  breaklines=true,
  showstringspaces=false
}

\title{Práctica 4: Módulos Odoo Modelo y Vista
}
\author{Eder Martínez Castro}
\date{\today}

\begin{document}
\maketitle
\tableofcontents
\clearpage


\section{Introducción}
\noindent El objetivo de esta práctica es seguir trabajando con el modelo y la vista de los módulos de Odoo, para ello
tendremos que implementar cuatro módulos, \textbf{Lista de tareas}, \textbf{Biblioteca de cómics}, \textbf{Pacientes y médicos}, \textbf{Ciclos formativos}.

\vspace{1em}
\noindent Antes de proceder a empezar con la práctica se nos recomienda revisar los ejemplos del 01 al 06 que tenemos en el siguiente 
repositorio \href{https://github.com/sergarb1/OdooModulosEjemplos.git}{github.com/sergarb1/OdooModulosEjemplos.git}.

\vspace{0.5em}
\noindent Para ello deberemos clonarlo en nuetro equipo utilizando el siguiete comando:
\begin{lstlisting}[style=bash]
  git clone https://github.com/sergarb1/OdooModulosEjemplos.git
\end{lstlisting}

\vspace{0.5em}
\noindent Cuando ya lo tengamos clonado lo que haremos es copiar los 6 ejemplos y pegarlos en nuestro proyecto para poder probarlos y revisarlos.
Y nos debería quedar nuestra carpeta con nuestro módulos tal que así:

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{PREVIO/MODULOS-EJEMPLO.png}
  \caption{Carpeta addons, que contiene nuestros módulos de Odoo donde podemos ver los módulos de ejemplo del repositorio para probarlos.}
\end{figure}

\noindent Entender estos módulos de ejemplo nos ayudará mucho para poder hacer la actividad 1 de lista de tareas y la 2 de la biblioteca de comics. 

\clearpage{}
\section{Actividad 01 - Lista de tareas}

\subsection{Objetivo}
\noindent Para esta actividad se nos pide coger el código de nuestro módulo de ejemplo 2 de la lista de tareas, para modificarlo e implementar en el que
podamos verlo además del \textbf{modo lista}, poder verlo en \textbf{modo kanban} y \textbf{calendario}.

\subsection{Agregar vista Kanban}
\noindent Para poder implementar la vista estilo kanban solo necesitamos modificar el archivo \texttt{views.xml} que es nuestra vista para poder implementar
este nuevo modo de visualización.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.1-AGREGAR-KANBAN.png}
  \caption{Nuevo fragmento de código para mostrar las tareas en formato kanban.}
\end{figure}

\noindent En este fragmento de código implementamos la nueva vista tipo kanban, que nos mostrará nuestras tareas en tarjetas individuales con los datos de la tarea.

\clearpage{}
\noindent Estrucutura principal de la vista Kanban:
\begin{itemize}
    \item \texttt{<kanban>}: muestra la vista en formato kanban como bien indica el nombre
    \item \texttt{<field>}: declaramos los campos que tendra la vista.
    \item \texttt{<templates>}: contiene la plantilla \texttt{kanban-box} donde creamos la tarjeta de la tarea del kanban:
    \begin{itemize}
        \item La tarjeta es interactiva al usar \texttt{oe\_kanban\_global\_click} si hacemos click en ella nos abrira el formulario para poder editarla.
        \item Se muestran los datos de la tarea: nombre, prioridad, urgencia y si está o no realizada.
    \end{itemize}
\end{itemize}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.1-AGREGAR-ACTION.png}
  \caption{En el bloque para las acciones de nuestro módulo debemos agregar como se ve en pantalla en el \texttt{view\_mode} el nuevo tipo kanban.}
\end{figure}

\noindent En esta modificación lo que hicimos fue agregar la vista kanban al \texttt{view\_mode}, porque Odoo utiliza este parámetro para determinar que vistas estarán disponibles en la interfaz de nuestro módulo.

\clearpage{}

\subsection{Comprobación de la vista Kanban}
\noindent A continuación vamos a enseñar a través de capturas de pantalla el correcto funcionamiento de nuestra vista kanban.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-1/1.1-VISTA-LISTA.png}
  \caption{En esta captura podemos ver la vista modo lista de nuestro módulo de listas de tareas que es la primera que nos saldrá cuando lo abramos.}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.3\linewidth]{EJERCICIO-1/1.1-CAMBIAR-A-KANBAN.png}
  \caption{Como se ve en esta captura para cambiar de vista nos iremos a estos iconos y pulsaremos en el que pone kanban para poder ver nuestras tareas en este formato}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-1/1.1-VISTA-KANBAN.png}
  \caption{En esta captura podemos ver la vista modo kanban de nuestro módulo de listas de tareas.}
\end{figure}

\noindent Aquí podemos ver nuestras tareas en tarjetas con todos sus campos relevantes, lo que muestra que tenemos la vista del kanban bien implementada.

\subsection{Agregar vista Calendar}
\noindent Para poder implementar la vista estilo calendar deberemos modificar el archivo \texttt{views.xml} que es nuestra vista y el archivo \texttt{models.py} que es nuestro modelo para poder implementar
este nuevo modo de visualización.

\vspace{1em}

\noindent Primero vamos a empezar modificando nuestro \texttt{models.py}:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-AGREGAR-CAMPOS-AL-MODEL.png}
  \caption{En esta captura podemos ver como hemos agregado a nuestra modelo los campos \texttt{fecha\_inicio} y \texttt{fecha\_fin} para poder marcar el comienzo de una tarea y su final.}
\end{figure}

\noindent Para que nuestra vista calendario pueda mostrar nuestras tareas, necesitamos crear dos nuevos campos para poder marcar la fecha de inicio de la tarea y la fecha de fin de esta.

\begin{itemize}
    \item \texttt{fecha\_inicio}: fecha en la que esta tarea empieza.
    \item \texttt{fecha\_fin}: fecha límite de la tarea.
\end{itemize}

\vspace{1em}

\noindent Ahora vamos a realizar las siguientes modificaciones en nuestro \texttt{views.xml}:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-AGREGAR-CALENDAR.png}
  \caption{Nuevo fragmento de código para mostrar las tareas en formato calendar.}
\end{figure}

\noindent En este fragmento de código implementamos la nueva vista tipo calendar, que nos mostrará un calendario con nuestras tareas desde el dia que empiezan hasta el dia que deben estar finalizadas.

\vspace{0.5em}

\noindent Estrucutura principal de la vista calendar:
\begin{itemize}
    \item \texttt{<calendar>}: muestra la vista en formato calendario como bien indica el nombre, esta recibe dos atributos:
    \begin{itemize}
        \item \texttt{date\_start="fecha\_inicio"}: indicamos el día de comienzo de la tarea.
        \item \texttt{date\_start="fecha\_fin"}: indicamos el día final de la tarea.
    \end{itemize}
    \item \texttt{<field>}: declaramos los campos que tendra la vista.
\end{itemize}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-AGREGAR-ACTION.png}
  \caption{En el bloque para las acciones de nuestro módulo debemos agregar como se ve en pantalla en el \texttt{view\_mode} el nuevo tipo calendar.}
\end{figure}

\noindent En esta modificación lo que hicimos fue agregar la vista calendar al \texttt{view\_mode}, como ya explicamos anteriormente esto es porque Odoo utiliza este parámetro para determinar que vistas estarán disponibles en la interfaz de nuestro módulo.

\clearpage{}

\noindent Ahora que ya hemos implementado nuestra vista kanban en el \texttt{views.xml}, pero todavía nos falta hacer unas modificaciones en los bloques
del formulario para poder agregar la fecha de inicio y fin a las tareas cuando las creemos o editemos, además de agregar estos nuevos campos de fecha a
las vistas de lista y kanban:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-ACTULIZAR-FORM.png}
  \caption{Actualizamos el bloque de formulario para tener un nuevo bloque para agregar las fechas de inicio y fin de la tarea para cuando agregemos una tarea o la editemos.}
\end{figure}

\noindent En el formulario, agregamos un nuevo grupo para las fechas de la tarea donde tenemos los campos de fecha de inicio y fecha final de la tarea, para cuando creemos y editemos una tarea podamos agregar las fechas.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-ACTUALIZAR-LIST.png}
  \caption{Actualizamos el bloque de la vista list para mostrar los nuevos campos de fechas de inicio y fin de la tarea.}
\end{figure}

\noindent En la vista de lista, agregamos los nuevos campos de fecha de inicio y fecha de final de la tarea como nuevas columnas.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-1/1.2-ACTUALIZAR-KANBAN.png}
  \caption{Actualizamos el bloque de la vista kanban para mostrar los nuevos campos de fechas de inicio y fin de la tarea.}
\end{figure}

\noindent En la vista de kanban, agregamos los nuevos campos de fecha de inicio y fecha de final de la tarea en la tarjeta del kanban.

\subsection{Comprobación de la vista Calendar}
\noindent A continuación vamos a enseñar a través de capturas de pantalla el correcto funcionamiento de la vista calendar que acabamos de implementar.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.3\linewidth]{EJERCICIO-1/1.2-CAMBIAR-A-CALENDAR.png}
  \caption{Como se pueder ver en esta captura para poder cambiar de vista nos iremos a estos iconos y pulsaremos en el que pone calendario.}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-1/1.2-VISTA-CALENDAR.png}
  \caption{En esta captura podemos ver la vista modo calendar de nuestro módulo de listas de tareas.}
\end{figure}

\noindent Aquí podemos ver como la tarea que creamos de \textbf{realizar un pedido para un cliente}, empieza el jueves 4 y termina el  viernes 18 de diciembre de 2025, lo que muestra que tenemos la vista del calendario bien implementada.

\section{Actividad 02 - Biblioteca de cómics}

\subsection{Objetivo}
\noindent Para esta actividad se nos pide ampliar el módulo del ejemplo 3 de la biblioteca de cómics simple para agregar la gestión de socios
y la gestión de ejemplares de préstamo. Para ello crearemos nuevos modelos que nos permiten almacenar los datos de los socios y de los ejemplares,
así como poder registrar los préstamos indicando el socio, la fecha de inicio y la fecha de devolución, aplicando las restricciones indicadas a las fechas.

\subsection{Modelo Socios}
\noindent A continuación vamos a crear el modelo de socios para nuesto módulo, para ello tendremos que crear la vista y el modelo además de realizar unas modificaciones para emplearlo.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.1-AGREGAR-MODELO-SOCIO.png}
  \caption{Captura del archivo \texttt{biblioteca\_socio.py} donde tenemos el modelo para gestionar socios.}
\end{figure}

\noindent Creamos el archivo \texttt{biblioteca\_socio.py} y definimos el modelo "biblioteca.socio", que se encargará de gestionar
los socios de la biblioteca de cómics. Cada socio tiene un identificador único, además de su nombre y apellido.

\vspace{0.5em}

\noindent Los atributos principales del modelo son:

\begin{itemize}
  \item id\_socio: identificador único para cada socio.
  \item nombre: nombre del socio.
  \item apellido: apellido del socio. 
\end{itemize}

\noindent Además, usamos una restricción SQL para asegurar que el \texttt{id\_socio} sea único.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.1-IMPORTAR-MODELO.png}
  \caption{Captura de que importamos el nuevo modelo socio en \texttt{models/\_\_init\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro modelo socios al iniciar el módulo, importamos el modelo en el archivo \texttt{models/\_\_init\_\_.py}
como ya teniamos el del modelo de cómic.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.1-AGREGAR-VISTA-SOCIO.png}
  \caption{Captura del archivo \texttt{biblioteca\_socio.xml} donde tenemos definida la vista para socios.}
\end{figure}

\noindent Creamos el archivo \texttt{biblioteca\_socio.xml} donde creamos la vista \texttt{socio} para poder gestionar los socios desde una interfaz donde tenemos lo siguiente:

\begin{itemize}
  \item \textbf{Vista formulario:} Esto nos permite tener un formulario donde podremos crear o editar la información de los socios.
  \item \textbf{Vista lista:} Esto nos muestra todos los socios en un listado formato tabla con los campos: identificador, nombre y apellido.
\end{itemize}

\noindent También agregamos la acción y el menú correspondientes para poder acceder a la vista de socios desde la interfaz.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.1-AGREGAR-VISTA-MANIFEST.png}
  \caption{Captura de que incluimos la nueva vista de socio en \texttt{\_\_manifest\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro vista de socios, tenemos que agregarlo dentro de \texttt{data} en el \texttt{\_\_manifest\_\_.py}
justo debajo de la vista de cómics.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.1-REGLAS-ACCESO.png}
  \caption{Captura donde actualizamos las reglas de acceso donde asignamos los permisos para socios.}
\end{figure}

\noindent Ahora, definimos las reglas de acceso, permitiendo a todos los usuarios poder ver los socios, pero solo los miembros del \textbf{grupo bibliotecario}
podrán crear, editar y eliminar los socios.


\subsection{Modelo Ejemplares}
\noindent A continuación vamos a crear el modelo de ejemplares para nuesto módulo, para ello tendremos
que crear la vista y el modelo además de realizar unas modificaciones para poder emplearlo.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.2-AGREGAR-MODELO-EJEMPLAR.png}
  \caption{Captura del archivo \texttt{biblioteca\_ejemplares.py} donde tenemos el modelo para gestionar los ejemplares.}
\end{figure}

\noindent Creamos el archivo \texttt{biblioteca\_ejemplar.py} y definimos el modelo \texttt{"biblioteca.comic.ejemplar"}. Este modelo nos permite gestionar cada ejemplar de un comic de nuestra biblioteca.
Cada ejemplar tiene un identificador único, una referencia al cómic al que pertenece, un estado y opcionalmente, un socio al que esta prestado y las fechas de prestamo y devolución.

\vspace{0.5em}

\noindent Los atributos principales del modelo son:

\begin{itemize}
  \item id\_ejemplar: identificador único para cada ejemplar.
  \item comic\_name: tenemos una relación \texttt{Many2one} hacia el modelo de cómic, ya que cada ejemplar pertenece a un único cómic.
  \item socio\_id: tenemos una relación \texttt{Many2one} hacia el modelo de socio, ya que cada ejemplar esta prestado a un socio.
  \item estado: indica si el ejemplar está disponible o está prestado.
  \item fecha\_prestamo: fecha en la que se presto el ejemplar.
  \item fecha\_devolucion: fecha prevista en la que se devolvera el ejemplar.
\end{itemize}

\noindent Además, usamos una restricción SQL para asegurar que el \texttt{id\_ejemplar} sea único.

\vspace{1em}

\noindent Agregamos las restricciones para las fechas:

\vspace{0.5em}

\noindent Incluimos dos comprobaciones mediante \texttt{@api.constrains}, así si se intenta guardar un ejemplar que incumpla alguna
de estás reglas que nos salte un error:

\begin{enumerate}
  \item Que la fecha de préstamo no puede ser posterior al día actual.
  \item Que la fecha de devolución no puede ser anterior al día actual.
\end{enumerate}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.2-IMPORTAR-MODELO.png}
  \caption{Captura de que importamos el nuevo modelo ejemplar en \texttt{models/\_\_init\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro modelo ejemplar al iniciar el módulo, importamos el modelo en el archivo \texttt{models/\_\_init\_\_.py}
como ya teniamos el del modelo de cómic y socio.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.2-AGREGAR-VISTA-EJEMPLAR.png}
  \caption{Captura del archivo \texttt{biblioteca\_ejemplar.xml} donde tenemos definida la vista para los ejemplares.}
\end{figure}

\noindent Creamos el archivo \texttt{biblioteca\_ejemplar.xml} donde creamos la vista \texttt{ejemplar} para poder gestionar los ejemplares desde una interfaz donde tenemos lo siguiente:

\begin{itemize}
  \item \textbf{Vista formulario:} Esto nos permite tener un formulario donde podremos crear o editar la información de los ejemplares.
  \item \textbf{Vista lista:} Esto nos muestra todos los ejemplares en un listado formato tabla con los campos: identificador del ejemplar, nombre del cómic, estado, identificador del socio, fecha del prestamo y de devolución.
\end{itemize}

\noindent También agregamos la acción y el menú correspondientes para poder acceder a la vista de ejemplares desde la interfaz.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.2-AGREGAR-VISTA-MANIFEST.png}
  \caption{Captura de que incluimos la nueva vista de ejemplar en \texttt{\_\_manifest\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro vista de ejemplares, tenemos que agregarlo dentro de \texttt{data} en el \texttt{\_\_manifest\_\_.py}
justo debajo de la vista de socios.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.2-REGLAS-ACCESO.png}
  \caption{Captura donde actualizamos las reglas de acceso donde asignamos los permisos para ejemplares.}
\end{figure}

\noindent Ahora, definimos las reglas de acceso, permitiendo a todos los usuarios poder ver los ejemplares, pero solo los miembros del \textbf{grupo bibliotecario}
podrán crear, editar y eliminar los ejemplares.

\subsection{Comprobación de su funcionamiento}

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-2/2.3-VISTA-COMICS.png}
  \caption{En esta captura tenemos la lista con todos los cómics que creamos para nuestra biblioteca.}
\end{figure}

\noindent Como podemos ver tenemos creados cinco cómics y vemos que se muestra correctamente en el formato lista, ademas podemos ver en el
menú las opciones cómics, socios y ejemplares, para movernos de modelo.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-2/2.3-VISTA-LIST-SOCIOS.png}
  \caption{En esta captura tenemos la lista con todos los socios que hemos creamos para nuestra biblioteca.}
\end{figure}

\noindent Como podemos ver estamos en la parte del modulo de socios donde los gestionamos, creamos cinco socios de ejemplos y los mostramos en el formato
lista correctamente.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.3-VISTA-FORM-SOCIOS.png}
  \caption{En está captura tenemos el formulario para crear y editar los socios.}
\end{figure}

\noindent Como podemos ver ahora estamos en la pantalla de crear o editar un socio donde podemos ver que tenemos los campos: identificador, nombre y apellido.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-2/2.3-VISTA-LIST-EJEMPLARES.png}
  \caption{En esta captura tenemos la lista con todos los ejemplares que hemos creamos para nuestra biblioteca.}
\end{figure}

\noindent Ahora nos encontramos en la parte del modulo de ejemplares donde los gestionamos, he creado 2 ejemplares de ejemplos y los mostramos en el formato
lista correctamente.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-2/2.3-VISTA-FORM-EJEMPLARES.png}
  \caption{En está captura tenemos el formulario para crear y editar nuestros ejemplares.}
\end{figure}

\noindent Como podemos ver ahora estamos en la pantalla de crear o editar un ejemplar donde podemos ver que tenemos los campos: identificador del ejemplar, nombre del cómic, estado, a que socio está prestado, en que fecha se presto y cuando se va a devolver.

\vspace{1em}

\noindent Por último vamos a mostrar las comprobaciones de que nuestras restricciones en las fechas en ejemplares están funcionando correctamente.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-2/2.3-COMPROBACION-RESTRICCION-1.png}
  \caption{En está captura comprobamos que la fecha de préstamo no puede ser posterior al día actual.}
\end{figure}

\noindent Aquí podemos ver como al intentar guardar un nuevo ejemplar con la fecha de prestamo 13/12/2025 nos salta el error ya que el dia en la intentamos registrar el ejemplar era 12/12/2025 y como definimos en la restricción no podemos registrar un inicio de prestamo en un fecha futura.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-2/2.3-COMPROBACION-RESTRICCION-2.png}
  \caption{En está captura comprobamos que la fecha prevista de devolución no puede ser anterior al día actual.}
\end{figure}

\noindent Aquí podemos ver como al intentar guardar un nuevo ejemplar con la fecha de devolución 11/12/2025 nos salta el error ya que el dia en la intentamos registrar el ejemplar era 12/12/2025 y como definimos en la restricción no podemos registrar una devolución de prestamo en un fecha ya pasada al día actual.

\section{Actividad 03 - Pacientes y médicos}

\subsection{Objetivo}
\noindent Para esta actividad tendremos que crear un módulo para gestionar los pacientes y médicos de un hospital, teniendo también un registro de las consultas. Para ello deberemos de crear los modelos para almacenar los datos de los médicos, pacientes y de las consultas, donde registramos
cada vez que un médico atiente a un paciente incluyendo el diagnostico dado por el médico.

\vspace{1em}
\noindent \underline{RECORDATORIO:}

\vspace{0.5em}

\noindent Para poder crear la estructura básica de un módulo, usaremos el comando \textbf{scaffold} a continuación mostraré los pasos a seguir:

\vspace{0.5em}

\noindent Comando para entrar en nuestro contenedor de docker

\begin{lstlisting}[style=bash]
  docker exec -it <CONTAINER> bash
\end{lstlisting}

\vspace{0.5em}

\noindent Comando para crear la estructura de nuestro módulo

\begin{lstlisting}[style=bash]
  odoo scaffold <MODULO_NAME> /mnt/extra-addons
\end{lstlisting}

\clearpage{}

\subsection{Modelo Paciente}

\noindent A continuación vamos a crear el modelo de pacientes donde almacenaremos los datos de los pacientes, para ello
tendremos que crear la vista y su modelo además de referenciar el nuevo modelo en el \texttt{\_\_init\_\_.py} de models y la vista en nuestro
\texttt{\_\_manifest\_\_.py}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.1-AGREGAR-MODELO-PACIENTE.png}
  \caption{Captura del archivo \texttt{paciente.py} donde tenemos el modelo para gestionar a los pacientes del hospital.}
\end{figure}

\noindent Creamos el archivo \texttt{paciente.py} y definimos el modelo \texttt{"paciente"}. Este modelo nos permite gestionar los pacientes del hospital.
Cada paciente cuenta con un un identificador único, sus datos personales y los síntomas que padece. Además contamos con un helper para poder recuperar su nombre
completo y facilitar la visualización.

\vspace{0.5em}

\noindent Los atributos principales del modelo son:

\begin{itemize}
  \item id\_paciente: identificador único para cada paciente.
  \item nombre: nombre del paciente.
  \item apellidos: apellidos del paciente.
  \item sintomas: descripción de los síntomas del paciente.
  \item nombre\_completo: combina el nombre + apellidos para obtener el nombre completo.
\end{itemize}

\noindent Además, usamos una restricción SQL para asegurar que el \texttt{id\_paciente} sea único.

\clearpage{}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.4\linewidth]{EJERCICIO-3/3.1-IMPORTAR-MODELO.png}
  \caption{Captura de que importamos el nuevo modelo paciente en \texttt{models/\_\_init\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro modelo paciente al iniciar el módulo, importamos el modelo en el archivo \texttt{models/\_\_init\_\_.py}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.1-AGREGAR-VISTA-PACIENTE.png}
  \caption{Captura del archivo \texttt{paciente.xml} donde tenemos definida la vista para los pacientes del hospital.}
\end{figure}

\noindent Creamos el archivo \texttt{paciente.xml} donde creamos la vista \texttt{paciente} para poder gestionar los pacientes desde una interfaz donde tenemos lo siguiente:

\begin{itemize}
  \item \textbf{Vista formulario:} Esto nos permite tener un formulario donde podremos crear o editar la información de los pacientes.
  \item \textbf{Vista lista:} Esto nos muestra todos los pacientes en un listado formato tabla con los campos: identificador del paciente, nombre, apellidos y síntomas.
\end{itemize}

\noindent También agregamos la acción y el menú correspondientes para poder acceder a la vista de pacientes desde la interfaz.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.6\linewidth]{EJERCICIO-3/3.1-AGREGAR-VISTA-MANIFEST.png}
  \caption{Captura de que incluimos la nueva vista de paciente en \texttt{\_\_manifest\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro vista de pacientes, tenemos que agregarlo dentro de \texttt{data} en el \texttt{\_\_manifest\_\_.py}.

\subsection{Modelo Médico}
\noindent A continuación vamos a crear el modelo de médicos donde almacenaremos los datos de los médicos, para ello
tendremos que crear la vista y su modelo además de referenciar el nuevo modelo en el \texttt{\_\_init\_\_.py} de models y la vista en nuestro
\texttt{\_\_manifest\_\_.py}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.1-AGREGAR-MODELO-PACIENTE.png}
  \caption{Captura del archivo \texttt{medico.py} donde tenemos el modelo para gestionar a los médicos del hospital.}
\end{figure}

\noindent Creamos el archivo \texttt{medico.py} y definimos el modelo \texttt{"medico"}. Este modelo nos permite almacenar la información de los médicos del hospital.
Cada médico cuenta con un un número de colegiado único, además de su nombre y apellidos. Y como hacemos en el modelo de paciente, contamos con un helper para poder recuperar su nombre
completo y facilitar la visualización.

\clearpage{}

\noindent Los atributos principales del modelo son:

\begin{itemize}
  \item num\_colegiado: número de colegiado del médico, que se usa como su identificador.
  \item nombre: nombre del médico.
  \item apellidos: apellidos del médico.
  \item nombre\_completo: combina el nombre + apellidos para obtener el nombre completo.
\end{itemize}

\noindent Además, usamos una restricción SQL para asegurar que el \texttt{num\_colegiado} sea único.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.4\linewidth]{EJERCICIO-3/3.1-IMPORTAR-MODELO.png}
  \caption{Captura de que importamos el nuevo modelo médico en \texttt{models/\_\_init\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro modelo médico al iniciar el módulo, importamos el modelo en el archivo \texttt{models/\_\_init\_\_.py}
como ya teniamos el de paciente.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.1-AGREGAR-VISTA-PACIENTE.png}
  \caption{Captura del archivo \texttt{medico.xml} donde tenemos definida la vista para los médicos del hospital.}
\end{figure}

\noindent Creamos el archivo \texttt{medico.xml} donde creamos la vista \texttt{medico} para poder gestionar los médicos desde una interfaz donde tenemos lo siguiente:

\begin{itemize}
  \item \textbf{Vista formulario:} Esto nos permite tener un formulario donde podremos crear o editar la información de los médicos.
  \item \textbf{Vista kanban:} Esto nos muestra a los médicos en formato de tarjetas, facilitando la visualización de estos, y mostramos su número de colegiado, nombre y apellidos.
\end{itemize}

\noindent También agregamos la acción y el menú correspondientes para poder acceder a la vista de médicos desde la interfaz.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.6\linewidth]{EJERCICIO-3/3.2-AGREGAR-VISTA-MANIFEST.png}
  \caption{Captura de que incluimos la nueva vista de médico en \texttt{\_\_manifest\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro vista de médicos, tenemos que agregarlo dentro de \texttt{data} en el \texttt{\_\_manifest\_\_.py}
justo debajo de la vista de paciente.

\clearpage{}

\subsection{Modelo Consulta}
\noindent A continuación vamos a crear el modelo para las consultas que registrará cada vez que un médico atiende a un paciente, para ello
tendremos que crear la vista y su modelo además de referenciar el nuevo modelo en el \texttt{\_\_init\_\_.py} de models y la vista en nuestro
\texttt{\_\_manifest\_\_.py}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.3-AGREGAR-MODELO-CONSULTA.png}
  \caption{Captura del archivo \texttt{consulta.py} donde tenemos el modelo para gestionar a las cosultas médicas.}
\end{figure}

\noindent Creamos el archivo \texttt{consulta.py} y definimos el modelo \texttt{``consulta"}. Este modelo nos permite almacenar la información de cada consulta realizada.
Cada consulta tiene un identificador único, y relaciona un médico con un paciente, registrando además el diagnóstico y la fecha de la cita.

\vspace{0.5em}

\noindent Los atributos principales del modelo son:

\begin{itemize}
  \item id\_consulta: identificador único de la consulta.
  \item medico\_id: indica que médico hace la consulta, y tenemos una relación \texttt{Many2one}, ya que cada médico puede atender varios pacientes.
  \item paciente\_id: indica el paciente atendido, y tenemos una relación \texttt{Many2one}, ya que cada paciente puede haber sido atendido por varios médicos.
  \item diagnostico: diagnóstico emitido por el médico.
  \item fecha\_cita: fecha en la que se realiza la consulta médica.
\end{itemize}

\noindent Además, usamos una restricción SQL para asegurar que el \texttt{id\_consulta} sea único.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.4\linewidth]{EJERCICIO-3/3.3-IMPORTAR-MODELO.png}
  \caption{Captura de que importamos el nuevo modelo consulta en \texttt{models/\_\_init\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro modelo consulta al iniciar el módulo, importamos el modelo en el archivo \texttt{models/\_\_init\_\_.py}
como ya teniamos el del modelo de paciente y médico.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.3-AGREGAR-VISTA-CONSULTA.png}
  \caption{Captura del archivo \texttt{consulta.xml} donde tenemos definida la vista para las consultas médicas.}
\end{figure}

\noindent Creamos el archivo \texttt{consulta.xml} donde creamos la vista \texttt{consulta} para poder gestionar las consultas desde una interfaz donde tenemos lo siguiente:

\begin{itemize}
  \item \textbf{Vista formulario:} Esto nos permite tener un formulario donde podremos crear o editar la información de las consultas.
  \item \textbf{Vista lista:} Esto nos muestra todas las consultas en un listado formato tabla con los campos: identificador de la consulta, médico que atendio, paciente atendido, diagnóstico y fecha de la cita.
  \item \textbf{Vista calendario:} Esto nos muestra todas las consultas en un calendario en la fecha en la que fue y nos permite visualizar mejor las citas médicas porque es como habitualmente estamos acostumbrados a verlas.
\end{itemize}

\noindent También agregamos la acción y el menú correspondientes para poder acceder a la vista de consultas desde la interfaz.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.6\linewidth]{EJERCICIO-3/3.3-AGREGAR-VISTA-MANIFEST.png}
  \caption{Captura de que incluimos la nueva vista de consulta en \texttt{\_\_manifest\_\_.py}.}
\end{figure}

\noindent Para que Odoo cargue nuestro vista de consulta, tenemos que agregarlo dentro de \texttt{data} en el \texttt{\_\_manifest\_\_.py}
justo debajo de la vista de paciente y medico.

\subsection{Comprobación de su funcionamiento}

\noindent Antes de mostrar el funcionamiento vamos a mostrar el error que nos sucedio antes de poder probarlo.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.4\linewidth]{EJERCICIO-3/ERROR-FALTA-PERMISOS.png}
  \caption{Captura de que no nos mostraba nuestro módulo \textbf{Gestión hospitalaria (Actividad 3)}.}
\end{figure}

\noindent Después de haber instalado nuestro módulo \textbf{gestión hospitalaria} no dirigimos al menú para entrar al módulo y no nos salía en el menú, esto nos pasaba porque
no teníamos permisos, en el módulo anterior no tuvimos es problema porque al tener el permiso del modelo comics lo replicamos para ejemplares y socios. Pero en este modulo no
los pusimos y por eso no se nos mostraba. A continuación las modificaciones realizadas para arreglarlo:

\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\linewidth]{EJERCICIO-3/SOULUCCION-ACTUALIZAR-MANIFEST.png}
  \caption{Habilitamos el \texttt{'security/ir.model.access.csv'} del data.}
\end{figure}

\noindent Lo primero va a ser volver a nuestro \texttt{\_\_manifest\_\_.py} y en la parte de \textbf{data} teniamos comentado
el archivo \texttt{'security/ir.model.access.csv'} lo descomentamos y ahora si nos iremos a modificar los permisos para poder ver nuesto módulo en Odoo.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/SOULUCCION-REGLAS-ACCESO.png}
  \caption{Actualizamos las reglas de acceso donde asignamos los permisos a los modelos.}
\end{figure}

\noindent Ahora en el \texttt{'security/ir.model.access.csv'} agregamos las reglas para permitir a los usuarios puedan \texttt{leer}, \texttt{crear}, \texttt{modificar}, \texttt{eliminar} los registros de 
\textbf{pacientes}, \textbf{médicos} y \textbf{consultas}. Permitiendonos así poder acceder y ver en el menú el módulo que creamos.

\vspace{1em}

\noindent Con este pequeño error que nos dío solventado, vamos a enseñar el resultado de nuestro módulo de gestión hospital:

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-3/3.4-VISTA-LIST-PACIENTES.png}
  \caption{En esta captura tenemos la lista con todos los pacientes que creamos para nuestro módulo de gestión hospitalaria.}
\end{figure}

\noindent Como podemos apreciar en la captura estamos en la vista de pacientes donde tenemos tres pacientes, y vemos que los mostramos correctamente en el formato lista, ya que un
hospital tiene muchos pacientes y el formato lista en mi opión no resulta muy útil, en la parte del menu tenemos las otras vistas de nuestro módulo
que son médicos y consultas para poder movernos de vista.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.4-VISTA-FORM-PACIENTES.png}
  \caption{En está captura tenemos el formulario para crear y editar los pacientes.}
\end{figure}

\noindent Como podemos ver ahora estamos en la vista de formulario de pacientes donde creamos o editamos un paciente y donde podemos ver que tenemos
los campos: identificador, nombre, apellidos y los síntomas.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-3/3.4-VISTA-KANBAN-MEDICOS.png}
  \caption{En esta captura mostramos los médicos que creamos para nuestro módulo en formato de tarjetas (kanban).}
\end{figure}

\noindent Esta es la vista de médicos donde mostramos los dos que creamos, y se visualizan en formato kanban ya que proporcionalmente hay muchos menos médicos que pacientes, me parecio
mejor usar la vista kanban ya que mostraremos los médicos en tarjetas y visualmente se ve mejor.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.4-VISTA-FORM-MEDICOS.png}
  \caption{En está captura tenemos el formulario para crear y editar los médicos.}
\end{figure}

\noindent Como podemos ver ahora estamos en la vista de formulario de médicos donde creamos o editamos un médico y donde podemos ver que tenemos
los campos: número de colegiado, nombre y apellidos.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-3/3.4-VISTA-LIST-CONSULTAS.png}
  \caption{En esta captura tenemos la lista con todas las consultas que creamos en el módulo.}
\end{figure}

\noindent Esta es la vista de consultas donde mostramos los tres consultas que creamos, y se visualiza en formato lista y tambien en calendario ya que un hospital o un centro de salud
se producen muchas citas y poder verlas en lista y en formato calendario nos facilita la visualización. 

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\linewidth]{EJERCICIO-3/3.4-VISTA-FORM-CONSULTAS.png}
  \caption{En está captura tenemos el formulario para crear y editar las consultas médicas.}
\end{figure}

\noindent Como podemos ver ahora estamos en la vista de formulario de consultas donde creamos o editamos una consulta y donde podemos ver que tenemos
los campos: identificador, médico que atiente, paciente, el diagnóstico y la fecha de la cita.

\begin{figure}[H]
  \centering
  \includegraphics[width=1\linewidth]{EJERCICIO-3/3.4-VISTA-CALENDAR-CONSULTAS.png}
  \caption{Aquí se ve la vista en formato calendario para ver en que día fue la consulta.}
\end{figure}

\noindent Aquí podemos ver la vista en formato calendario para mostrar las consultas, está la agregué adicionalmente porque se hace muy visual ver las citas en un calendario
además de emplear el campo agregado adicionalmente \texttt{fecha\_cita} que nos permite poder ver las consultas en este modo de visualización.

\section{Actividad 04 - Ciclos formativos}

\section{Conclusión}

\end{document}