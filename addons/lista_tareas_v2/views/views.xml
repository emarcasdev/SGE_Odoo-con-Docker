<!-- Declaración del archivo XML principal de vistas -->
<odoo>
  <data>

    <!-- ==================================================
         ACCIÓN PRINCIPAL DEL MÓDULO
         ===================================================
         Esta acción es la que se ejecutará cuando el usuario 
         entre en el menú "Ver tareas".
         Abre el modelo lista_tareas.lista mostrando sus vistas.
    -->
    <record model="ir.actions.act_window" id="action_lista_tareas">
      <!-- Título visible de la ventana -->
      <field name="name">Listado de tareas (Actividad 1)</field>

      <!-- Modelo al que se refiere la acción -->
      <field name="res_model">lista_tareas.lista</field>

      <!-- Tipo de vistas que se mostrarán:
           list → vista en tabla
           form → vista en formulario 
           kanban -> vista kanban
           calendar -> vista calendario -->
      <field name="view_mode">list,form,kanban,calendar</field>
    </record>

    <!-- ==================================================
         MENÚS DEL MÓDULO
         ===================================================
         Creamos la estructura jerárquica de menús en Odoo.
         Esto permite al usuario acceder a las vistas.
    -->

    <!-- Menú raíz que aparece en la barra superior -->
    <menuitem id="lista_tareas_menu_root" name="Listado de tareas" sequence="10"/>

    <!-- Submenú dentro del menú raíz.
         Permite agrupar más opciones si lo necesitas en el futuro. -->
    <menuitem id="lista_tareas_menu_1" name="Gestión de tareas"
              parent="lista_tareas_menu_root" sequence="20"/>

    <!-- Opción final de menú que ejecuta la acción definida arriba.
         Abre la interfaz con lista y formulario de tareas. -->
    <menuitem id="lista_tareas_menu_1_list" name="Ver tareas"
              parent="lista_tareas_menu_1" action="action_lista_tareas" sequence="30"/>

    <!-- ==================================================
         VISTA DE LISTA (list)
         ===================================================
         Muestra las tareas en forma de tabla.
         Es la vista que se usa por defecto para ver varios registros.
    -->
    <record id="view_lista_tareas_list" model="ir.ui.view">
      <!-- Nombre interno de la vista -->
      <field name="name">lista.tareas.list</field>
      <!-- Modelo al que pertenece esta vista -->
      <field name="model">lista_tareas.lista</field>
      <!-- Estructura XML de la vista -->
      <field name="arch" type="xml">
        <!-- Vista tipo list (reemplaza a <tree> en Odoo 17+) -->
        <list string="Tareas" default_order="prioridad desc">
          <!-- Campos que se muestran como columnas -->
          <field name="tarea"/>         <!-- Nombre de la tarea -->
          <field name="prioridad"/>     <!-- Nivel de prioridad -->
          <field name="urgente"/>       <!-- Calculado automáticamente -->
          <field name="realizada"/>     <!-- Estado de finalización -->
          <field name="fecha_inicio"/>  <!-- Fecha de inicio -->
          <field name="fecha_fin"/>     <!-- Fecha de fin -->
        </list>
      </field>
    </record>

    <!-- ==================================================
         VISTA DE FORMULARIO (form)
         ===================================================
         Se usa al crear o editar una tarea.
         Más amigable y detallada que la vista de lista.
    -->
    <record id="view_lista_tareas_form" model="ir.ui.view">
      <field name="name">lista.tareas.form</field>
      <field name="model">lista_tareas.lista</field>
      <field name="arch" type="xml">
        <form string="Tarea">
          <!-- El contenedor visual principal del formulario -->
          <sheet>
            <!-- Primer bloque de campos (agrupados) -->
            <group>
              <field name="tarea"/>         <!-- Campo de nombre de tarea -->
              <field name="realizada"/>     <!-- Campo para marcar como realizada -->
            </group>

            <!-- Segundo bloque de campos (prioridad y urgencia) -->
            <group string="Prioridad y urgencia">
              <field name="prioridad"/>     <!-- Campo de prioridad editable -->

              <!-- Campo calculado: no editable. Ya no usamos attrs (Odoo 17+) -->
              <field name="urgente" readonly="1"/>
            </group>

            <!-- Tercer bloque de campos para las fechas de la tarea -->
            <group string="Fechas de la tarea">
              <field name="fecha_inicio"/>
              <field name="fecha_fin"/>
            </group>

          </sheet>
        </form>
      </field>
    </record>

    <!-- ==================================================
         VISTA DE KANBAN
         ================================================== -->
    <record id="view_lista_tareas_kanban" model="ir.ui.view">
      <!-- Nombre interno de la vista -->
      <field name="name">lista.tareas.kanban</field>
      <!-- Modelo al que pertenece esta vista -->
      <field name="model">lista_tareas.lista</field>
      <!-- Estructura XML de la vista -->
      <field name="arch" type="xml">
        <!-- Vista tipo kanban -->
        <kanban default_order_by="realizada">
          <field name="tarea"/>
          <field name="prioridad"/>
          <field name="urgente"/>
          <field name="realizada"/>

          <templates>
            <!-- Tarjeta de las tareas de kanban -->
            <t t-name="kanban-box">
              <div class="oe_kanban_card oe_kanban_global_click">
                <strong><field name="tarea"/></strong>
                <div>
                  <div>Prioridad: <field name="prioridad"/></div>
                  <div>Urgente: <field name="urgente"/></div>
                  <div>Realizada: <field name="realizada"/></div>
                  <div>Fecha de inicio: <field name="fecha_inicio"/></div>
                  <div>Fecha de fin: <field name="fecha_fin"/></div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    <!-- ==================================================
         VISTA DE CALENDARIO
         ================================================== -->
    <record id="view_lista_tareas_calendar" model="ir.ui.view">
      <!-- Nombre interno de la vista -->
      <field name="name">lista.tareas.calendar</field>
      <!-- Modelo al que pertenece esta vista -->
      <field name="model">lista_tareas.lista</field>
      <!-- Estructura XML de la vista -->
      <field name="arch" type="xml">
        <!-- Vista tipo calendar -->
        <calendar date_start="fecha_inicio" date_stop="fecha_fin">
          <field name="tarea"/>
          <field name="prioridad"/>
          <field name="urgente"/>
          <field name="realizada"/>
        </calendar>
      </field>
    </record>

    <!-- ==================================================
         VISTA DE BÚSQUEDA (search)
         ===================================================
         Aparece como la barra superior de búsqueda en la vista de lista.
         Permite buscar y filtrar tareas por varios criterios.
    -->
    <record id="view_lista_tareas_search" model="ir.ui.view">
      <field name="name">lista.tareas.search</field>
      <field name="model">lista_tareas.lista</field>
      <field name="arch" type="xml">
        <search string="Buscar tareas">

          <!-- Campo de búsqueda libre -->
          <field name="tarea"/>

          <!-- Filtros predefinidos -->
          <filter name="filtro_urgente" string="Urgente"
                  domain="[('urgente','=',True)]"/>

          <filter name="filtro_realizada" string="Realizadas"
                  domain="[('realizada','=',True)]"/>
        </search>
      </field>
    </record>

  </data>
</odoo>
